\input{config/header}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% document specific %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% define the author, title etc
\globalTitle{Interpreter Manual}
\globalSubject{setlX v\input{version}}
\globalAuthor{Herrmann, Tom}
\globalDate{\today}
\globalKeywords{readme}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% setup %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{config/configuration}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% document text %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\begin{titlepage}
\maketitle

\vfill

\begin{center}
\Large
``Computers make very fast, very accurate mistakes.''
\end{center}

\vfill
\tableofcontents
\end{titlepage}

\section{Overview}

This is the manual of \setlX, an interpreter for the very high level programming language \SetlX{} (\underline{set} \underline{l}anguage e\underline{x}tended).

The most distinguishing feature of this language is the support it offers for sets and lists.
As set theory is the language of mathematics, many mathematical algorithms that are formulated in terms of set theory have very straightforward implementations in \SetlX{}.

Designed mostly by Karl Stroetmann, the \SetlX{} language is an evolution of \Setl{} by Jack Schwartz.
It was specifically conceived to make the unique features of \Setl{} more accessible to today's computer science students.

The \setlX{} interpreter, which currently is the \SetlX{} reference implementation, was implemented by Tom Herrmann. Its official homepage is \url{http://setlX.randoom.org/}. You may send bug-reports and\slash{}or questions about the \setlX{} interpreter via e-mail to \mailto{setlx@randoom.org}, or create an issue on github (\url{https://github.com/herrmanntom/setlX}).

\section{Installation}

To comfortably use \setlX{} it may be installed into the search-path. After this is done, it may be launched just like any other command-line program on your system.

\subsection{Unix-like OS (Linux, MacOS X, etc.)}

\begin{enumerate}
	\item Copy all `\command{setlX*.jar}'-files into some folder, which is accessible by all users, who should be able to execute \setlX{} (e.g. `\command{/usr/local/setlX/}').\\
	You may also copy them into the home directory of some user, when she is the only \setlX-user on the system (e.g. `\command{/home/<user>/programs/setlX/}').
	\item Copy the contents of the default `\command{setlXlibrary}' into some folder for each user (e.g. `\command{/home/<user>/setlXlibrary/}').
	\item Open the `\command{setlX}'-script in your favorite editor (either `\command{vi}' or `\command{emacs}' of course).
	\item Change the contents of the `\command{setlXJarDirectory}'-variable to the path where you copied the jar-files, e.g.
\begin{lstlisting}[frame=none,numbers=none]
setlXJarDirectory="/usr/local/setlX/"
\end{lstlisting}
	\item Change the `\command{setlXlibraryPath}'-variable to the path where \setlX{} should look for library files, e.g.
\begin{lstlisting}[frame=none,numbers=none]
setlXlibraryPath="$HOME/setlXlibrary/"
\end{lstlisting}
	\item Save and close the file.
	\item Copy the modified `\command{setlX}'-script into some folder, which is in the search-path of all users which should be able to execute \setlX{} (e.g. `\command{/usr/local/bin}').\\
	When only used by one user, you may copy it into the `bin' directory in her home instead (e.g. `\command{/home/<user>/bin}').
	\item Make the copied script executable, e.g.
\begin{lstlisting}[frame=none,numbers=none]
chmod +x /usr/local/bin/setlX
\end{lstlisting}
	\item (Optional) You should also install the `\command{rlwrap}' utility to greatly increase the usability of the interactive mode (see \ref{LimitationsInteractiveMode}). 

\end{enumerate}

\subsection{MacOS X with homebrew}\label{MacOsHomebrew}

\setlX{} may be installed easily if you use homebrew (\url{http://brew.sh/}). Just follow the very short instructions by Niklas Korz at \url{https://github.com/niklaskorz/homebrew-setlx}.

\subsection{Microsoft Windows}

\begin{center}
\large
``Here's a nickel, kid. Go buy yourself a real computer.''\footnote{In reference to \url{http://dilbert.com/1995-06-24}}
\end{center}

\begin{enumerate}
	\item Copy all `\command{setlX*.jar}' files and the `\command{setlX.cmd}' file into some folder, which is accessible by all users, who should be able to execute \setlX{} (e.g. `\command{C:\textbackslash{}Program Files\textbackslash{}setlX\textbackslash{}}').
	\item Copy the contents of the default `\command{setlXlibrary}' into some folder for each user (e.g. `\command{C:\textbackslash{}Program Files\textbackslash{}setlX\textbackslash{}library}').
	\item Open the copied `\command{setlX.cmd}'-script in your favorite text editor.
	\item Change the contents of the `\command{setlXJarDirectory}'-variable to the path where you copied the jar-files, e.g.
\begin{lstlisting}[frame=none,numbers=none]
set setlXJarDirectory=C:\Program Files\setlX\
\end{lstlisting}
	\item Change the `\command{SETLX\_LIBRARY\_PATH}'-variable and set it to the path where \setlX{} should look for library files, e.g.
\begin{lstlisting}[frame=none,numbers=none]
set SETLX_LIBRARY_PATH=C:\Program Files\setlX\library
\end{lstlisting}
	\item Save and close the file.
	\item Add the folder you placed both files into to the search-path (requires Administrator privileges):
	\begin{enumerate}
		\item Press \command{[Win]+[Pause]} key combination to open system preferences.
		\item 
		\begin{itemize}
			\item On Windows Vista or newer:\\Click on `\command{Advanced system settings}' on the left pane, which opens a new window.
			\item On Windows XP or older:\\Click the `\command{Advanced}' tab in the current window.
		\end{itemize}
		\item Click on `\command{Environment Variables}' on the bottom, which opens another window.
		\item Select the `\command{Path}' variable in the `\command{System variables}' section and click on `\command{Edit...}', which opens jet another window.
		\item Do not alter the existing content of the `\command{Variable value}' field, but add a semicolon (`\command{;}'), followed by the full path to the folder where you installed setlX, to its very end. Using the previous example path, the new value should look like:
\begin{lstlisting}[frame=none,numbers=none]
<previous value>;C:\Program Files\setlX
\end{lstlisting}
		\item Accept all changes by clicking `\command{OK}' in all windows you opened before.
		\item End you current session and login into Windows again.
	\end{enumerate}
\end{enumerate}

\newpage

\section{Usage}

The \setlX{} interpreter has two basic modes of operation:

\begin{itemize}
	\item file execution mode, which can be launched with
\begin{lstlisting}[frame=none,numbers=none]
setlX <path>/<name>.stlx
\end{lstlisting}
	\item interactive mode, which can be launched with
\begin{lstlisting}[frame=none,numbers=none]
setlX
\end{lstlisting}
\end{itemize}

The `file execution mode' will be started if one or more paths to code files are supplied as parameters for this program. These files will then be parsed and executed in the order in which they are listed as parameters. When executing multiple files, they share the outermost scope.

When no paths are supplied, the `interactive mode' will be started.\\
Executing the `\command{exit;}' statement will terminate the interpreter.

\subsection*{Additional parameters}
\addcontentsline{toc}{subsection}{--- Additional parameters}

In addition to file-paths a number of options can be used when running \setlX{}:

\begin{itemize}
    \param{-l <path>, --libraryPath <path>}
	      {Override SETLX\_LIBRARY\_PATH environment variable.}
	\param{-a, --noAssert}
	      {Disables all assert functions.}
	\param{-n, --noExecution}
	      {Load and check code for syntax errors, but do not execute it (has no effect in interactive mode).}
	\param{-r, --predictableRandom}
	      {Always returns the same pseudo random sequence of numbers from the internal random number generator (for debugging).}
	\param{-p <argument> ..., --params <argument> ...}
	      {Pass all following arguments to the executed program via `params' variable.}
	\param{-e <expression>, --eval <expression>}
	      {Evaluates next argument as expression and exits (cannot be combined with execution of a statement or files).}
	\param{-x <statement>, --exec <statement>}
	      {Executes next argument as statement and exits (cannot be combined with evaluation of an expression or execution of files).}
	\param{-v, --verbose}
          {Display the parsed program before executing it (has no effect in interactive mode).}
	\param{--doubleDefault\\
	       --doubleScientific\\
	       --doubleEngineering\\
	       --doublePlain}
          {Sets how the exponent of doubles is printed.}
	\param{-h, --harshWelcome}
	      {Interactive mode: Reduce welcome message to a bare minimum.}
	\param{-m, --multiLineMode}
	      {Interactive mode: Only accept input after additional new line.}
	\param{--help}
	      {Displays some helpful information.}
	\param{--version}
          {Display interpreter version and terminate.}
\end{itemize}

\section{System Requirements}

To run \setlX{} a Java runtime (JRE) is required, which is compatible to Java version 1.7 (aka version 7) or higher.

When building from source, the Java Development Kit (JDK) version 1.7 (but not higher) and an Apache Maven installation have to be present as well.

The hardware requirements are highly dependent on the executed \SetlX{} program. At least 512 MB of free main-memory should be available for optimal performance in most situations.

\section{Limitations}

\subsection{Out of Memory Error}

Due to its implementation and execution by the Java Virtual Machine (JVM), an `out of memory error' might be encountered when executing \SetlX{} programs using deep recursion, very large or very many sets and\slash{}or lists.

The JVM is only able to dynamically increase its memory allocation in very limited bounds, no matter how much free memory is available.

To work around these problems, edit the used launching script (`\command{setlX}' or `\command{setlX.cmd}') with a text editor and follow the directions given at the top.

\subsection{Input in Interactive Mode on Unix}\label{LimitationsInteractiveMode}

On UNIX (-like) systems, the prompt in interactive mode does not handle control sequences correctly. This is a Java limitation and no platform independent solutions are available. You may install the `rlwrap' program to work around this issue.

%\subsection{Known Bugs}
%The following bugs are known to be present in this version of the interpreter:
%
%\begin{itemize}
%	\item ...
%\end{itemize}

\section{Building from source}

Optionally, when the interpreter source is available, the interpreter can be (re)build by executing

\begin{lstlisting}[frame=none,numbers=none]
mvn clean install
\end{lstlisting}

in the `\command{interpreter}' folder.

A self-contained `.jar' file will be created, which can be launched on all Java-Platforms without additional scripts, jars or environment-variables by executing

\begin{lstlisting}[frame=none,numbers=none]
java -jar setlX.jar <path>/<name>.stlx
\end{lstlisting}

or

\begin{lstlisting}[frame=none,numbers=none]
java -jar setlX.jar
\end{lstlisting}

However, the \command{setlX} and \command{setlX.cmd} scripts can also be used to launch the jar file created by this process.

\section{Disclaimer}

\includeListing[h]{../license.txt}{}{license}{}{setlX license}

\end{document}
